# Escrow Fix - Invalid Share Error

## Проблема
При создании escrow счета сразу после создания bill возникает ошибка:
```
failed to estimate gas for user operation: useroperation reverted: Invalid share
```

## Причина
Контракт `SplitBillEscrow` требует, чтобы все shares были > 0. Когда счет создается без позиций, все shares = 0, что вызывает ошибку.

## Решение
Изменена логика создания escrow:
1. ✅ При создании bill с escrow - счет создается локально
2. ✅ Показывается сообщение: "Bill created! Add items and participants to activate escrow"
3. ⏳ После добавления позиций - пользователь может активировать escrow

## Изменения

### src/app/page.tsx
- Убрана немедленная создание escrow контракта
- Добавлено информационное сообщение
- Escrow флаг сохраняется в bill для последующей активации

## Следующие шаги

### Вариант 1: Кнопка "Activate Escrow" (рекомендуется)
Добавить на страницу счета кнопку для активации escrow после добавления позиций:
- Проверять, что есть позиции и участники
- Показывать кнопку "Activate Escrow Protection"
- При нажатии - создавать escrow контракт

### Вариант 2: Автоматическая активация
Автоматически создавать escrow контракт когда:
- Добавлена хотя бы одна позиция
- Есть хотя бы один участник
- Все shares > 0

### Вариант 3: Упрощенный flow
Убрать checkbox "Use Escrow" при создании bill:
- Добавить кнопку "Use Escrow" на странице готового счета
- Пользователь сначала создает счет, добавляет позиции
- Затем решает использовать escrow или нет

## Рекомендация
Используйте **Вариант 1** - это дает пользователю контроль и понятный flow:
1. Создать счет
2. Добавить позиции и участников
3. Нажать "Activate Escrow Protection"
4. Подтвердить транзакцию

## Текущий статус
✅ Ошибка исправлена - счет создается без ошибок
⏳ Нужно добавить UI для активации escrow после добавления позиций

## Временное решение
Пока можно:
1. Создавать счета без escrow
2. Использовать direct payment mode
3. Escrow функционал доступен, но требует ручной активации через код

## Для production
Нужно реализовать один из вариантов выше для полного UX.
